(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65573,       1755]
NotebookOptionsPosition[     60690,       1677]
NotebookOutlinePosition[     61075,       1693]
CellTagsIndexPosition[     61032,       1690]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "\:043f\:0440\:043e\:0441\:0442\:0440\:0430\:043d\:0441\:0442\:0432\:0435\
\:043d\:043d\:044b\:0435", " ", 
   "\:043f\:043e\:0432\:043e\:0440\:043e\:0442\:044b"}], "*)"}]], "Input",
 CellChangeTimes->{{3.845373499722332*^9, 
  3.8453735076795363`*^9}},ExpressionUUID->"914bcae7-e892-454f-9a42-\
c694a2927b6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rz", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "\[Phi]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "0"},
      {"0", "0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rx", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
      {"0", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ry", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.845362282820029*^9, {3.8453623219474936`*^9, 3.845362441903722*^9}, {
   3.845362473481122*^9, 3.845362521998597*^9}, {3.845363509850127*^9, 
   3.8453635361151104`*^9}, {3.8453635791498003`*^9, 3.8453635814310274`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"42db5c98-dac8-4a86-b995-67c89805fbcb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\:0430\:043d\
\:0438\:0435", " ", 
    "\:043f\:0435\:0440\:0435\:0432\:043e\:0434\:044f\:0449\:0435\:0435", " ",
     "\:0432\:0435\:043a\:0442\:043e\:0440", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", "\:0432", " ", 
    "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:0435", " ",
     "\:0432\:0435\:043a\:0442\:043e\:0440\:0430", " ", "kin"}], " ", "=", 
   " ", 
   RowBox[{"k0", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8453734665365567`*^9, 3.8453734940841484`*^9}, {
  3.845636890294281*^9, 
  3.8456369126201305`*^9}},ExpressionUUID->"c566b57e-a4a3-4d0b-828a-\
154b0afd3c7d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kin", "=", 
  RowBox[{"k0", " ", 
   RowBox[{"rz", ".", "ry", ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.845362377185415*^9, 3.8453623818259635`*^9}, {
  3.8453624608564243`*^9, 3.845362461090796*^9}, {3.845362502983392*^9, 
  3.8453625031240206`*^9}, {3.8453625386545024`*^9, 3.845362566383759*^9}, {
  3.8453626664596305`*^9, 3.8453627182866316`*^9}, {3.845637039795403*^9, 
  3.845637045835955*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"0ab6ba4d-b88c-4765-87c2-ec077042e95a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k0", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{"k0", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{"k0", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.845362382359421*^9, 3.8453623912810974`*^9}, 
   3.8453624615282593`*^9, 3.845362503795874*^9, 3.845362544013731*^9, {
   3.845362684224861*^9, 3.8453627184272285`*^9}, {3.845363523438354*^9, 
   3.84536354203685*^9}, 3.8453635889231105`*^9, 3.8456368360381327`*^9, 
   3.845637047334474*^9, 3.8463074097515717`*^9, 3.84631595819477*^9, 
   3.846374125008037*^9, 3.8481990388217354`*^9, 3.8496937098468275`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"f33f618f-6516-4f81-aed1-39eb68409bb0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043e\:0442\:0440\:0430\:0436\:0435\:043d\:043d\:044b\:0439", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440", " ", "kout"}], "=", 
   RowBox[{"kin", "/.", 
    RowBox[{"\[Theta]", "\[Rule]", " ", 
     RowBox[{"\[Pi]", "-", "\[Theta]"}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8456369372222786`*^9, 3.84563693765376*^9}, 
   3.845637001919243*^9},ExpressionUUID->"e5aa14e7-a7e8-43d4-a561-\
e15d3a3b41a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kout", "=", 
  RowBox[{"k0", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.845637058284957*^9, 3.845637059885217*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"0eba5488-7917-4438-91df-3d5d338f1700"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k0", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{"k0", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "k0"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8463074118350077`*^9, 3.8463159605228405`*^9, 
  3.8463741274454794`*^9, 3.8481990406078424`*^9, 3.849693712518639*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"116dfcf0-8e63-48b8-afc7-2ca2b72a6b0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043c\:0430\:0442\:0440\:0438\:0446\:0430", " ", 
    "\:043f\:043b\:043e\:0442\:043d\:043e\:0441\:0442\:0438", " ", 
    "\:0434\:043b\:044f", " ", "k"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.845373443616041*^9, 
  3.845373458514976*^9}},ExpressionUUID->"c16a038a-6fae-4531-a919-\
97c419ee2238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"1", "+", "\[Xi]3"}], 
        RowBox[{"\[Xi]1", "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Xi]2"}]}], "0"},
       {
        RowBox[{"\[Xi]1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Xi]2"}]}], 
        RowBox[{"1", "-", "\[Xi]3"}], "0"},
       {"0", "0", "0"}
      }], "\[NoBreak]", ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.845363011391892*^9, 3.8453630614348106`*^9}, 
   3.8453630940369263`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"a8054418-e59d-4341-8867-6cf9c681706f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043c\:0430\:0442\:0440\:0438\:0446\:0430", " ", 
    "\:043f\:043b\:043e\:0442\:043d\:043e\:0441\:0442\:0438", " ", 
    "\:0434\:043b\:044f", "  ", 
    "\:0432\:043e\:043b\:043d\:043e\:0432\:043e\:0433\:043e", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:0430", " ", "kin"}], "=", 
   RowBox[{"k0", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.845373597769746*^9, 3.845373601725191*^9}, {
  3.8453737501560154`*^9, 3.84537375231026*^9}, {3.8456367573842125`*^9, 
  3.8456367575740204`*^9}, {3.845637070638446*^9, 
  3.8456370713307333`*^9}},ExpressionUUID->"7645749b-6ecd-44c8-8e61-\
3c41035ec4e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]in", "=", 
   RowBox[{
    RowBox[{"rz", ".", "ry", ".", "\[Rho]", ".", 
     RowBox[{"Transpose", "[", "ry", "]"}], ".", 
     RowBox[{"Transpose", "[", "rz", "]"}]}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.845363113599041*^9, 3.8453631380044746`*^9}, {
   3.845374853732879*^9, 3.8453748564047117`*^9}, 3.845636779886918*^9, {
   3.845636859240528*^9, 3.84563685966891*^9}, 3.8481990510249147`*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"804dc163-667a-44a6-99f8-656485432a7d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043c\:0430\:0442\:0440\:0438\:0446\:0430", " ", 
    "\:043f\:043b\:043e\:0442\:043d\:043e\:0441\:0442\:0438", " ", 
    "\[Rho]out"}], " ", "=", " ", 
   RowBox[{"\[Rho]in", "/.", 
    RowBox[{"\[Theta]", "\[Rule]", " ", 
     RowBox[{"\[Pi]", "-", "\[Theta]"}]}]}]}], " ", "*)"}]], "Input",Expressio\
nUUID->"3a27d75b-82bf-4986-a8c1-44cc1a6bcab4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Rho]out", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]in", "/.", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Pi]", "-", "\[Theta]"}]}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Xi]1", "\[Rule]", " ", "\[Xi]1out"}], ",", 
         RowBox[{"\[Xi]2", "\[Rule]", " ", "\[Xi]2out"}], ",", 
         RowBox[{"\[Xi]3", "\[Rule]", " ", "\[Xi]3out"}]}], "}"}]}], "//", 
      "Simplify"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Rho]out", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]in", "/.", 
        RowBox[{"\[Theta]", "\[Rule]", "\[Theta]p"}]}], "/.", 
       RowBox[{"\[Phi]", "\[Rule]", " ", "\[Phi]p"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]1", "\[Rule]", " ", "\[Xi]1out"}], ",", 
        RowBox[{"\[Xi]2", "\[Rule]", " ", "\[Xi]2out"}], ",", 
        RowBox[{"\[Xi]3", "\[Rule]", " ", "\[Xi]3out"}]}], "}"}]}], "//", 
     "Simplify"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8496937271689215`*^9, 3.849693744964737*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f459f044-e5a9-4b38-9699-b978f579576a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8480342735782595`*^9, 
  3.848034275104811*^9}},ExpressionUUID->"a6b83cd0-9cd4-440f-9412-\
dbd86ca9fafc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "\:0424\:0443\:0440\:044c\:0435", " ", 
   "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\:0442\:044b",
    " ", "\:0442\:0435\:043d\:0437\:043e\:0440\:0430", " ", 
   "\:043f\:0440\:043e\:043d\:0438\:0446\:0430\:0435\:043c\:043e\:0441\:0442\
\:0438"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8453740824814916`*^9, 
  3.8453741019079123`*^9}},ExpressionUUID->"a08485d3-197b-49a3-b971-\
214f7d723a7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]p2", "=", 
   RowBox[{"FourierCoefficient", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"e0", "+", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", "1"}], 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"e0", "-", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", "1"}], 
         RowBox[{"B", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], 
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], 
         RowBox[{"e3", "-", "1"}]}
       }], "\[NoBreak]", ")"}], ",", "z", ",", 
     RowBox[{"-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]p1", "=", 
   RowBox[{"FourierCoefficient", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"e0", "+", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"e0", "-", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", 
            RowBox[{"Conjugate", "[", "r", "]"}]}], "]"}]}], 
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", 
            RowBox[{"Conjugate", "[", "r", "]"}]}], "]"}]}], "e3"}
       }], "\[NoBreak]", ")"}], ",", "z", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]p0", "=", 
   RowBox[{"FourierCoefficient", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"e0", "+", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"e0", "-", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", 
            RowBox[{"Conjugate", "[", "r", "]"}]}], "]"}]}], 
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", 
            RowBox[{"Conjugate", "[", "r", "]"}]}], "]"}]}], "e3"}
       }], "\[NoBreak]", ")"}], ",", "z", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]m2", "=", 
   RowBox[{"FourierCoefficient", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"e0", "+", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"e0", "-", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], 
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], "e3"}
       }], "\[NoBreak]", ")"}], ",", "z", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]m1", "=", 
   RowBox[{"FourierCoefficient", "[", 
    RowBox[{
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"e0", "+", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "z"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Y"}]}], 
         RowBox[{"e0", "-", 
          RowBox[{"A", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "z"}], "]"}]}]}], 
         RowBox[{"B", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "r"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], 
         RowBox[{
          RowBox[{"Conjugate", "[", "B", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"z", "+", "rc"}], "]"}]}], "e3"}
       }], "\[NoBreak]", ")"}], ",", "z", ",", "1"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.84537426237809*^9, 3.845374319306636*^9}, {
  3.845376820456398*^9, 3.8453768444089823`*^9}, {3.845376940009108*^9, 
  3.8453769695032663`*^9}, {3.845377198001297*^9, 3.845377204532402*^9}, {
  3.8453775126222525`*^9, 3.845377531278115*^9}, {3.8463162452009277`*^9, 
  3.8463162800489163`*^9}, {3.848199092410881*^9, 3.8481991017576685`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"09922fff-c099-45bb-b142-01a6142e92ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reals", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]1", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]2", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]3", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Phi]", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Theta]", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]1out", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]2out", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"\[Xi]3out", ",", "Reals"}], "]"}], ",", 
     RowBox[{"Element", "[", 
      RowBox[{"A", ",", "Reals"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.845637345199888*^9, 3.845637354567955*^9}, {
  3.8456373971414537`*^9, 3.845637398057042*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"3c65c764-5575-4934-b1e4-728fa0259788"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "\:043a\:0432\:0430\:0434\:0440\:0430\:0442\:0430", " ", 
    "\:0430\:043c\:043f\:043b\:0438\:0442\:0443\:0434\:044b", " ", "Tr", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Epsilon]\[Rho]", "in"], 
      SuperscriptBox["\[Epsilon]", "dagger"], 
      SubscriptBox["\[Rho]", "out"]}], ")"}]}], "==", 
   RowBox[{
    SuperscriptBox["\[Epsilon]", "dagger"], 
    SubscriptBox["\[Rho]", "in"], 
    SubscriptBox["\[Epsilon]\[Rho]", "out"]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8456372612648168`*^9, 3.845637308428172*^9}, {
  3.846307580449785*^9, 3.8463076936807384`*^9}, {3.8481991807683535`*^9, 
  3.8481991858261538`*^9}},ExpressionUUID->"52ada9d3-e6fe-4d97-b2ea-\
d56e7f55b65c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P2", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]p2", ".", "\[Rho]in", ".", 
       RowBox[{"ConjugateTranspose", "[", "\[Epsilon]p2", "]"}], ".", 
       "\[Rho]out"}], ",", "reals"}], "]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8481991572254324`*^9, 3.8481991721116605`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8dff0350-ce8e-4601-af4a-3b7fb59a9c20"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "64"], " ", 
  SuperscriptBox["A", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"3", "-", "\[Xi]3", "-", 
    RowBox[{"4", " ", "\[Xi]2", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"3", "-", "\[Xi]3out", "+", 
    RowBox[{"4", " ", "\[Xi]2out", " ", 
     RowBox[{"Cos", "[", "\[Theta]p", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Theta]p"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.848199132106923*^9, 3.8481991742104063`*^9, 
  3.8481992107568674`*^9, 3.8482078782721715`*^9, 3.8496937727043533`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"03265be7-125b-4bfb-a60a-0eb96aac3916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]p1", ".", "\[Rho]in", ".", 
         RowBox[{"ConjugateTranspose", "[", "\[Epsilon]p1", "]"}], ".", 
         "\[Rho]out"}], ",", "reals"}], "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"Conjugate", "[", "r", "]"}], "\[Rule]", " ", "rc"}]}], "/.", 
    RowBox[{
     RowBox[{"Conjugate", "[", "B", "]"}], "\[Rule]", "Bc"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8453768642679176`*^9, 3.845376907416057*^9}, {
  3.8453769806280127`*^9, 3.845377030861272*^9}, {3.8453770652818594`*^9, 
  3.845377067009438*^9}, {3.845637544388772*^9, 3.845637563428895*^9}, {
  3.8456378438364935`*^9, 3.8456378629287977`*^9}, {3.845637933073267*^9, 
  3.8456379341119566`*^9}, {3.8456386894854026`*^9, 3.845638693651417*^9}, {
  3.8463163011467524`*^9, 3.846316329614829*^9}, {3.8482061909172516`*^9, 
  3.8482061992059507`*^9}, {3.848206518543606*^9, 3.8482065201809764`*^9}, {
  3.848206646022838*^9, 3.8482066467259703`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0fe4ddc0-604b-499b-bdf0-d1917cb44b99"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "B", " ", "Bc", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"3", "-", "\[Xi]3", "-", 
       RowBox[{"4", " ", "\[Xi]2", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]p", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["B", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Xi]1"}], "-", "\[Xi]2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]1out", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Xi]2out"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["Bc", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Xi]1"}], "-", "\[Xi]2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Xi]1out", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Xi]2out"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["B", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"\[Xi]1", "-", 
       RowBox[{"\[ImaginaryI]", " ", "\[Xi]2"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]1out", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Xi]2out"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["Bc", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Xi]1"}], "-", "\[Xi]2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]1out", "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Xi]2out"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "B", " ", "Bc", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Xi]2out"}], "+", 
          RowBox[{"\[Xi]1out", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Phi]p"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Xi]3out", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "B", " ", "Bc", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Xi]2out"}], "+", 
          RowBox[{"\[Xi]1out", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Phi]p"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Xi]3out", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"B", " ", "Bc", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Phi]p", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", "\[Xi]1out", " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]p", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Xi]3out"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Phi]p", "]"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"B", " ", "Bc", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Xi]3out"}], ")"}]}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Phi]p", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]3out"}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Phi]p", "]"}], "2"]}], "+", 
          RowBox[{"\[Xi]1out", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Phi]p"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.8453768745020638`*^9, 3.8453769292124457`*^9, {3.845376991377775*^9, 
   3.8453770110492115`*^9}, 3.8453770427516317`*^9, 3.8453771576740427`*^9, {
   3.8456375412156277`*^9, 3.845637551380113*^9}, {3.84563784170714*^9, 
   3.8456378637153387`*^9}, 3.8456379347710876`*^9, 3.845638701872217*^9, 
   3.8456393486410685`*^9, {3.8463163190213003`*^9, 3.8463163489580936`*^9}, 
   3.8463218208477764`*^9, 3.846374166057149*^9, 3.84819922714029*^9, 
   3.8482062081119785`*^9, 3.848206397068874*^9, 3.8482065097443285`*^9, {
   3.8482066436791377`*^9, 3.8482066513820906`*^9}, {3.8482078043997784`*^9, 
   3.8482078386661406`*^9}, 3.8496937948715343`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"cab407df-489b-4a19-9e60-6d7d4a655791"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "\:043f\:043e\:0432\:0435\:0440\:0445\:043d\:043e\:0441\:0442\:044c", " ", 
   "\:0441\:0442\:043e\:043a\:0441\:0430"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8456387782955675`*^9, 
  3.8456387863810415`*^9}},ExpressionUUID->"1a790c7b-b6bf-489d-9175-\
f64d7a0ac3f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surfin", "=", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Xi]1", "2"], "+", 
     SuperscriptBox["\[Xi]2", "2"], "+", 
     SuperscriptBox["\[Xi]3", "2"], "-", "1"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surf", "=", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Xi]1out", "2"], "+", 
     SuperscriptBox["\[Xi]2out", "2"], "+", 
     SuperscriptBox["\[Xi]3out", "2"], "-", "1"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846317759344027*^9, 3.846317765074773*^9}, {
  3.846322664625138*^9, 3.84632271888688*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b32b6901-d9d0-4895-a974-b1df7c6771c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0434\:043b\:044f", " ", "\:0432\:043a\:043b\:0430\:0434\:0430", " ", 
     "\:0444\:0443\:0440\:044c\:0435", " ", 
     "\:043a\:043e\:043c\:043f\:043e\:043d\:0435\:043d\:0442\:044b"}], " ", 
    "+", "2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:0438\:043d\:0438\:043c\:0430\:0437\:0430\:0446\:0438\:044f", " ", 
    "\:043d\:0430", " ", 
    "\:043f\:043e\:0432\:0435\:0440\:0445\:043d\:043e\:0441\:0442\:0438", " ",
     "\:0441", " ", 
    "\:043b\:0430\:0433\:0440\:043d\:0430\:0436\:0435\:0432\:044b\:043c", " ",
     "\:043c\:043d\:043e\:0436\:0438\:0442\:0435\:043b\:0435\:043c", " ", 
    "\[Lambda]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8456388044020853`*^9, 3.845638819417753*^9}, {
  3.8456389080523853`*^9, 3.845638930577688*^9}, {3.8482064844566183`*^9, 
  3.84820648487846*^9}},ExpressionUUID->"8ab0f7ee-790f-4830-b8ff-\
fee81379aa67"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqs2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P2", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]1out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P2", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]2out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P2", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]3out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P2", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Lambda]"}], "]"}]}], 
     "}"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol2", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"eqs2", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Xi]1out", ",", "\[Xi]2out", ",", "\[Xi]3out", ",", "\[Lambda]"}], 
      "}"}]}], "]"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.8456379580436726`*^9, 3.8456381719642496`*^9}, {
  3.845638794506939*^9, 3.8456387957589617`*^9}, {3.846317724501495*^9, 
  3.846317754734788*^9}, {3.8463178990450506`*^9, 3.8463179042792788`*^9}, {
  3.846317983519068*^9, 3.846317990565781*^9}, {3.846321233324908*^9, 
  3.8463212375781517`*^9}, {3.8482064164927626`*^9, 3.8482064173833942`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"614ec597-1d31-4be1-af2f-62167bede1fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1out", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Xi]2out", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Theta]p", "]"}]}], 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]]}]}], ",", 
     RowBox[{"\[Xi]3out", "\[Rule]", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]p", "]"}], "2"], 
       SqrtBox[
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["A", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "-", "\[Xi]3", "-", 
           RowBox[{"4", " ", "\[Xi]2", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Theta]p"}], "]"}]}], ")"}], "2"]}], 
        RowBox[{"256", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]}]]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1out", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Xi]2out", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Theta]p", "]"}]}], 
       SqrtBox[
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]]}], ",", 
     RowBox[{"\[Xi]3out", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]p", "]"}], "2"], 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]]}]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      FractionBox[
       RowBox[{
        SuperscriptBox["A", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", "\[Xi]3", "-", 
          RowBox[{"4", " ", "\[Xi]2", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]3"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]p"}], "]"}]}], ")"}], "2"]}], 
       RowBox[{"256", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]p", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]p", "]"}], "4"]}]]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.845638034718357*^9, 3.8456380788089657`*^9, 3.845638138026346*^9, 
   3.8456381750259094`*^9, 3.845638655956768*^9, 3.8463176826274786`*^9, 
   3.8463177723558226`*^9, {3.846317908685421*^9, 3.8463179214038696`*^9}, 
   3.8463179912532625`*^9, 3.8463212390883017`*^9, 3.846374175088187*^9, 
   3.848199270658738*^9, 3.848206420664545*^9, {3.8482078697935114`*^9, 
   3.8482078836481233`*^9}, 3.849693820547882*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"b2a29ea1-c4cf-4a11-880f-babcd54eb8b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "\:043a", " ", "\:043c\:0430\:043a\:0441\:0438\:043c\:0443\:043c\:0443", 
   " ", "\:043e\:0442\:043d\:043e\:0441\:0438\:0442\:0441\:044f", " ", 
   "\:0432\:0442\:043e\:0440\:043e\:0435", " ", 
   "\:0440\:0435\:0448\:0435\:043d\:0438\:0435"}], "*)"}]], "Input",
 CellChangeTimes->{{3.845638847940541*^9, 3.845638862425393*^9}, {
  3.8482079045449533`*^9, 
  3.848207909028428*^9}},ExpressionUUID->"28c29752-356d-4767-b74a-\
97ecb597063a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"P2", "/.", 
     RowBox[{"sol2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{"\[Theta]", "\[Rule]", " ", "0"}]}], "/.", 
  RowBox[{"\[Theta]p", "\[Rule]", " ", "\[Pi]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"P2", "/.", 
     RowBox[{"sol2", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{"\[Theta]", "\[Rule]", " ", "0"}]}], "/.", 
  RowBox[{"\[Theta]p", "\[Rule]", " ", "\[Pi]"}]}]}], "Input",
 CellChangeTimes->{{3.8456382651648855`*^9, 3.8456383302572055`*^9}, {
  3.8463178062981644`*^9, 3.8463178094543514`*^9}, {3.846317936653515*^9, 
  3.846317937575361*^9}, {3.846318032783533*^9, 3.8463180339085045`*^9}, {
  3.8481993660105257`*^9, 3.848199367217663*^9}, {3.848199438905835*^9, 
  3.8481994610861063`*^9}, {3.8496938400566893`*^9, 3.8496938658845367`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7d32b125-1d46-42bf-8ca5-8a6ad200d4b0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8456383067295103`*^9, 3.8456383321344357`*^9}, 
   3.845638669797429*^9, 3.8463178123761454`*^9, 3.846317939309696*^9, 
   3.8463180009561567`*^9, 3.84631803543972*^9, 3.8481993686857257`*^9, {
   3.848199445366997*^9, 3.848199461682684*^9}, 3.8482064461198397`*^9, 
   3.848207888466541*^9, {3.849693828666313*^9, 3.849693870228153*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"7178b571-b471-4381-98ff-48731b5c76f8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  SuperscriptBox["A", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"4", "-", 
    RowBox[{"4", " ", "\[Xi]2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8456383067295103`*^9, 3.8456383321344357`*^9}, 
   3.845638669797429*^9, 3.8463178123761454`*^9, 3.846317939309696*^9, 
   3.8463180009561567`*^9, 3.84631803543972*^9, 3.8481993686857257`*^9, {
   3.848199445366997*^9, 3.848199461682684*^9}, 3.8482064461198397`*^9, 
   3.848207888466541*^9, {3.849693828666313*^9, 3.849693870228153*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"c87163be-8bfe-43c6-a1e3-8b553b07e5f9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.845638973616969*^9, 
  3.845638980869521*^9}},ExpressionUUID->"95d035e6-fa7e-44f4-bf42-\
8cb3fea0c7c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0434\:043b\:044f", " ", "\:0432\:043a\:043b\:0430\:0434\:0430", " ", 
     "\:0444\:0443\:0440\:044c\:0435", " ", 
     "\:043a\:043e\:043c\:043f\:043e\:043d\:0435\:043d\:0442\:044b"}], " ", 
    "+", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:0438\:043d\:0438\:043c\:0430\:0437\:0430\:0446\:0438\:044f", " ", 
    "\:043d\:0430", " ", 
    "\:043f\:043e\:0432\:0435\:0440\:0445\:043d\:043e\:0441\:0442\:0438", " ",
     "\:0441", " ", 
    "\:043b\:0430\:0433\:0440\:043d\:0430\:0436\:0435\:0432\:044b\:043c", " ",
     "\:043c\:043d\:043e\:0436\:0438\:0442\:0435\:043b\:0435\:043c", " ", 
    "\[Lambda]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8454466484576893`*^9, 3.8454466573056517`*^9}, 
   3.845638970597542*^9, 
   3.845639039801146*^9},ExpressionUUID->"62e9d119-c161-4077-80f6-\
9e0a0a7eb6c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs1out", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P1", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]1out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P1", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]2out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P1", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Xi]3out"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"P1", "-", 
         RowBox[{"\[Lambda]", " ", "surf"}]}], ",", "\[Lambda]"}], "]"}]}], 
     "}"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.846322829252762*^9, 3.8463228656989584`*^9}, 
   3.848199568136346*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"6884138a-1bc1-410d-9567-38e9e51e2947"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f1out", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"D", "[", 
    RowBox[{"P1", ",", "\[Xi]1out"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f2out", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"D", "[", 
    RowBox[{"P1", ",", "\[Xi]2out"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f3out", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"D", "[", 
    RowBox[{"P1", ",", "\[Xi]3out"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs1o", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f1", "[", "\[Theta]", "]"}], "-", 
      RowBox[{"2", "\[Lambda]", " ", "\[Xi]1out"}]}], ",", 
     RowBox[{
      RowBox[{"f2", "[", "\[Theta]", "]"}], "-", 
      RowBox[{"2", "\[Lambda]", " ", "\[Xi]2out"}]}], ",", 
     RowBox[{
      RowBox[{"f3", "[", "\[Theta]", "]"}], "-", 
      RowBox[{"2", "\[Lambda]", " ", "\[Xi]3out"}]}], ",", 
     RowBox[{"-", "surf"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84564048196553*^9, 3.845640589972931*^9}, {
   3.846321974413864*^9, 3.846322014480365*^9}, 3.846322065051841*^9, {
   3.8463229656590576`*^9, 3.8463229680721593`*^9}, {3.8482004904214525`*^9, 
   3.8482004971011324`*^9}, {3.8482006006657877`*^9, 3.8482006149913015`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"2d02b251-b27d-4a4e-afc0-8cd26f0f5cb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0438", " ", 
    "\:043b\:0438\:043d\:0435\:0439\:043d\:043e\:0441\:0442\:0438", " ", 
    "\:0438", " ", 
    "\:043a\:043e\:0440\:0440\:0435\:043a\:0442\:043d\:043e\:0441\:0442\:0438\
"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"f1out", ",", "\[Xi]1out"}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"f3out", ",", "\[Xi]3out"}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"f3out", ",", "\[Xi]3out"}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"eqs1out", "-", "eqs1o"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"f1", "[", "\[Theta]", "]"}], "\[Rule]", " ", 
        RowBox[{"f1out", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"f2", "[", "\[Theta]", "]"}], "\[Rule]", " ", 
        RowBox[{"f2out", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"f3", "[", "\[Theta]", "]"}], "\[Rule]", " ", 
        RowBox[{"f3out", "[", "\[Theta]", "]"}]}]}], "}"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.848200566613109*^9, 3.848200571565674*^9}, {
  3.8482006233565235`*^9, 3.8482006610677853`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"91cf8e41-33c4-40fb-a605-d458dba76771"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8482006640710816`*^9, 3.848206248676108*^9, 
  3.848206679839642*^9, 3.8482079522572217`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"5ac1f9c8-22a3-4e78-9198-c4b42320f3b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8482006640710816`*^9, 3.848206248676108*^9, 
  3.848206679839642*^9, 3.8482079522653728`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"98297e6d-1f7b-4c26-8642-bebc0cf83d84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"eqs1o", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\[Xi]1out", ",", "\[Xi]2out", ",", "\[Xi]3out", ",", "\[Lambda]"}], 
      "}"}]}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8482006787637453`*^9, 3.848200712419297*^9}, {
  3.8482007758515368`*^9, 3.848200806423204*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"7f2cad14-0cca-42e2-9eb8-0ef4b2a61a1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1out", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"f1", "[", "\[Theta]", "]"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}]}], ",", 
     RowBox[{"\[Xi]2out", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"f2", "[", "\[Theta]", "]"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}]}], ",", 
     RowBox[{"\[Xi]3out", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"f3", "[", "\[Theta]", "]"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]1out", "\[Rule]", 
      FractionBox[
       RowBox[{"f1", "[", "\[Theta]", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}], ",", 
     RowBox[{"\[Xi]2out", "\[Rule]", 
      FractionBox[
       RowBox[{"f2", "[", "\[Theta]", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}], ",", 
     RowBox[{"\[Xi]3out", "\[Rule]", 
      FractionBox[
       RowBox[{"f3", "[", "\[Theta]", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"f1", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f2", "[", "\[Theta]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"f3", "[", "\[Theta]", "]"}], "2"]}]]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.848200724590722*^9, {3.848200760595321*^9, 3.848200778428172*^9}, 
   3.8482008181423025`*^9, 3.8482062555918617`*^9, {3.848206668352753*^9, 
   3.84820668262083*^9}, 3.8482079563644953`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"3c174752-2a8f-48b9-b22c-97fb54b6c811"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"f1out", "[", "\[Theta]", "]"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"f1out", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f2out", "[", "\[Theta]", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"f3out", "[", "\[Theta]", "]"}], "2"]}]]], "/.", 
       RowBox[{"\[Xi]1", "\[Rule]", " ", "0"}]}], "/.", 
      RowBox[{"\[Xi]2", "\[Rule]", " ", "0"}]}], "/.", 
     RowBox[{"\[Xi]3", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], " ", ",", 
    RowBox[{"\[Theta]", "\[Rule]", " ", "0"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8482082488653045`*^9, 3.848208290143783*^9}, {
  3.848208329511874*^9, 3.8482084114586067`*^9}, {3.848208613510497*^9, 
  3.8482086944334135`*^9}},ExpressionUUID->"3cf25344-94b1-4eaa-b1d9-\
1f9a8f2858bc"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["B", "2"], "-", 
     SuperscriptBox["Bc", "2"]}], ")"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"r", "+", "rc"}], ")"}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["B", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"r", "+", "rc"}], ")"}]}]]}], "+", 
       RowBox[{
        SuperscriptBox["Bc", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"r", "+", "rc"}], ")"}]}]]}], "+", 
       RowBox[{"B", " ", "Bc", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "r"}]], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "rc"}]]}]}], ")"}]}]}], 
      ")"}], "2"]}]]]], "Output",
 CellChangeTimes->{{3.8482083198070755`*^9, 3.8482084119430285`*^9}, {
  3.84820861853913*^9, 3.84820867969635*^9}},
 CellLabel->"Out[71]=",ExpressionUUID->"f711d068-fe44-4f79-87f8-bfedb1f67b5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"f3out", "[", "\[Theta]", "]"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"f1out", "[", "\[Theta]", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"f2out", "[", "\[Theta]", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"f3out", "[", "\[Theta]", "]"}], "2"]}]]], "/.", 
     RowBox[{"\[Xi]1", "\[Rule]", " ", "0"}]}], "/.", 
    RowBox[{"\[Xi]2", "\[Rule]", " ", "0"}]}], "/.", 
   RowBox[{"\[Xi]3", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8482087000019636`*^9, 3.848208708422846*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"75ccc03b-ed9f-49e8-84e8-787213c5f181"],

Cell[BoxData[
 FractionBox[
  RowBox[{"B", " ", "Bc", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["B", "2"], " ", 
    SuperscriptBox["Bc", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{"r", "-", "rc"}], ")"}]}]], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}]]]], "Output",
 CellChangeTimes->{{3.8482087013710313`*^9, 3.848208709023327*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"6d3befbe-4cea-4770-8080-b4a520d7e1bc"]
}, Open  ]]
},
WindowSize->{1257, 1358},
WindowMargins->{{791, Automatic}, {Automatic, 42}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 353, 8, 28, "Input",ExpressionUUID->"914bcae7-e892-454f-9a42-c694a2927b6c"],
Cell[914, 30, 1493, 41, 177, "Input",ExpressionUUID->"42db5c98-dac8-4a86-b995-67c89805fbcb"],
Cell[2410, 73, 1076, 26, 28, "Input",ExpressionUUID->"c566b57e-a4a3-4d0b-828a-154b0afd3c7d"],
Cell[CellGroupData[{
Cell[3511, 103, 570, 11, 28, "Input",ExpressionUUID->"0ab6ba4d-b88c-4765-87c2-ec077042e95a"],
Cell[4084, 116, 881, 17, 32, "Output",ExpressionUUID->"f33f618f-6516-4f81-aed1-39eb68409bb0"]
}, Open  ]],
Cell[4980, 136, 476, 11, 28, "Input",ExpressionUUID->"e5aa14e7-a7e8-43d4-a561-e15d3a3b41a2"],
Cell[CellGroupData[{
Cell[5481, 151, 548, 14, 45, "Input",ExpressionUUID->"0eba5488-7917-4438-91df-3d5d338f1700"],
Cell[6032, 167, 608, 14, 32, "Output",ExpressionUUID->"116dfcf0-8e63-48b8-afc7-2ca2b72a6b0e"]
}, Open  ]],
Cell[6655, 184, 428, 11, 28, "Input",ExpressionUUID->"c16a038a-6fae-4531-a919-97c419ee2238"],
Cell[7086, 197, 657, 18, 61, "Input",ExpressionUUID->"a8054418-e59d-4341-8867-6cf9c681706f"],
Cell[7746, 217, 995, 24, 28, "Input",ExpressionUUID->"7645749b-6ecd-44c8-8e61-3c41035ec4e2"],
Cell[8744, 243, 548, 11, 45, "Input",ExpressionUUID->"804dc163-667a-44a6-99f8-656485432a7d"],
Cell[9295, 256, 408, 10, 28, "Input",ExpressionUUID->"3a27d75b-82bf-4986-a8c1-44cc1a6bcab4"],
Cell[9706, 268, 1226, 31, 64, "Input",ExpressionUUID->"f459f044-e5a9-4b38-9699-b978f579576a"],
Cell[10935, 301, 154, 3, 28, "Input",ExpressionUUID->"a6b83cd0-9cd4-440f-9412-dbd86ca9fafc"],
Cell[11092, 306, 459, 10, 28, "Input",ExpressionUUID->"a08485d3-197b-49a3-b971-214f7d723a7a"],
Cell[11554, 318, 7701, 221, 381, "Input",ExpressionUUID->"09922fff-c099-45bb-b142-01a6142e92ac"],
Cell[19258, 541, 1049, 25, 82, "Input",ExpressionUUID->"3c65c764-5575-4934-b1e4-728fa0259788"],
Cell[20310, 568, 756, 18, 32, "Input",ExpressionUUID->"52ada9d3-e6fe-4d97-b2ea-d56e7f55b65c"],
Cell[CellGroupData[{
Cell[21091, 590, 471, 11, 45, "Input",ExpressionUUID->"8dff0350-ce8e-4601-af4a-3b7fb59a9c20"],
Cell[21565, 603, 951, 24, 49, "Output",ExpressionUUID->"03265be7-125b-4bfb-a60a-0eb96aac3916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22553, 632, 1184, 24, 45, "Input",ExpressionUUID->"0fe4ddc0-604b-499b-bdf0-d1917cb44b99"],
Cell[23740, 658, 10349, 273, 248, "Output",ExpressionUUID->"cab407df-489b-4a19-9e60-6d7d4a655791"]
}, Open  ]],
Cell[34104, 934, 311, 7, 28, "Input",ExpressionUUID->"1a790c7b-b6bf-489d-9175-f64d7a0ac3f6"],
Cell[34418, 943, 680, 18, 55, "Input",ExpressionUUID->"b32b6901-d9d0-4895-a974-b1df7c6771c6"],
Cell[35101, 963, 2258, 61, 67, "Input",ExpressionUUID->"8ab0f7ee-790f-4830-b8ff-fee81379aa67"],
Cell[CellGroupData[{
Cell[37384, 1028, 1487, 37, 82, "Input",ExpressionUUID->"614ec597-1d31-4be1-af2f-62167bede1fc"],
Cell[38874, 1067, 4263, 117, 121, "Output",ExpressionUUID->"b2a29ea1-c4cf-4a11-880f-babcd54eb8b6"]
}, Open  ]],
Cell[43152, 1187, 483, 10, 28, "Input",ExpressionUUID->"28c29752-356d-4767-b74a-97ecb597063a"],
Cell[CellGroupData[{
Cell[43660, 1201, 1026, 22, 82, "Input",ExpressionUUID->"7d32b125-1d46-42bf-8ca5-8a6ad200d4b0"],
Cell[44689, 1225, 468, 6, 32, "Output",ExpressionUUID->"7178b571-b471-4381-98ff-48731b5c76f8"],
Cell[45160, 1233, 622, 12, 82, "Output",ExpressionUUID->"c87163be-8bfe-43c6-a1e3-8b553b07e5f9"]
}, Open  ]],
Cell[45797, 1248, 1399, 43, 28, "Input",ExpressionUUID->"95d035e6-fa7e-44f4-bf42-8cb3fea0c7c6"],
Cell[47199, 1293, 918, 21, 48, "Input",ExpressionUUID->"62e9d119-c161-4077-80f6-9e0a0a7eb6c4"],
Cell[48120, 1316, 911, 25, 45, "Input",ExpressionUUID->"6884138a-1bc1-410d-9567-38e9e51e2947"],
Cell[49034, 1343, 1406, 34, 140, "Input",ExpressionUUID->"2d02b251-b27d-4a4e-afc0-8cd26f0f5cb8"],
Cell[CellGroupData[{
Cell[50465, 1381, 1391, 36, 101, "Input",ExpressionUUID->"91cf8e41-33c4-40fb-a605-d458dba76771"],
Cell[51859, 1419, 277, 5, 32, "Output",ExpressionUUID->"5ac1f9c8-22a3-4e78-9198-c4b42320f3b0"],
Cell[52139, 1426, 287, 5, 32, "Output",ExpressionUUID->"98297e6d-1f7b-4c26-8642-bebc0cf83d84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52463, 1436, 494, 12, 45, "Input",ExpressionUUID->"7f2cad14-0cca-42e2-9eb8-0ef4b2a61a1a"],
Cell[52960, 1450, 3699, 104, 117, "Output",ExpressionUUID->"3c174752-2a8f-48b9-b22c-97fb54b6c811"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56696, 1559, 987, 26, 76, "Input",ExpressionUUID->"3cf25344-94b1-4eaa-b1d9-1f9a8f2858bc"],
Cell[57686, 1587, 1430, 40, 65, "Output",ExpressionUUID->"f711d068-fe44-4f79-87f8-bfedb1f67b5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59153, 1632, 766, 20, 76, "Input",ExpressionUUID->"75ccc03b-ed9f-49e8-84e8-787213c5f181"],
Cell[59922, 1654, 752, 20, 65, "Output",ExpressionUUID->"6d3befbe-4cea-4770-8080-b4a520d7e1bc"]
}, Open  ]]
}
]
*)

